<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏à‡∏∏‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì Wi-Fi (Voronoi)</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        * { box-sizing: border-box; }
        
        /* ‡∏à‡∏±‡∏î Layout ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö */
        body {
            font-family: 'Sarabun', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; /* ‡πÄ‡∏û‡∏¥‡πà‡∏° Font ‡πÑ‡∏ó‡∏¢‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Default */
            margin: 0; padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex; 
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px);
            padding: 10px 20px;
            display: flex; align-items: center; justify-content: center;
            gap: 15px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            flex-shrink: 0;
            z-index: 1000;
        }
        
        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß (Badge Style) */
        .header-logo-wrapper {
            width: 55px; height: 55px;
            border-radius: 50%;
            background: white; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
            padding: 5px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏ö */
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.2); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥ */
            overflow: hidden;
        }
        .header-logo { 
            width: 100%; height: 100%; 
            object-fit: contain; 
            /* ‡∏•‡∏ö mix-blend-mode ‡∏≠‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏µ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß */
        }
        
        .header-content { display: flex; flex-direction: column; }
        
        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î Font ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° */
        .header-title { 
            color: white; 
            font-size: clamp(1.1rem, 2.5vw, 1.4rem); 
            font-weight: 700; 
            margin: 0; 
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3); 
        }
        .header-subtitle { 
            color: rgba(255, 255, 255, 0.95); 
            font-size: clamp(0.75rem, 2vw, 0.9rem); 
            margin: 4px 0 0 0; 
            font-weight: 500;
        }

        /* Container & Layout */
        #container {
            display: flex; 
            flex-direction: column; 
            flex-grow: 1; /* ‡∏¢‡∏∑‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà */
            width: 100%;
            overflow: hidden;
            position: relative;
        }

        /* Controls */
        #controls {
            width: 100%; padding: 20px; background: white; 
            overflow-y: auto;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 500;
        }

        /* Map */
        #map { 
            width: 100%; 
            height: 40vh; /* Mobile Height */
            flex-grow: 1;
            z-index: 1; 
            transition: cursor 0.3s; 
        }
        
        .crosshair-cursor { cursor: crosshair !important; }

        /* Footer */
        footer {
            background: rgba(0, 0, 0, 0.3); color: white; text-align: center;
            padding: 8px; font-size: 0.8rem; 
            flex-shrink: 0;
        }

        /* Components */
        h2 { border-bottom: 3px solid #667eea; padding-bottom: 8px; color: #333; margin-top: 0; font-size: 1.1rem; }
        .building-input {
            display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 10px;
            padding: 10px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;
        }
        .building-input label { font-size: 0.9rem; font-weight: 600; min-width: 60px; display: flex; align-items: center; }
        .building-input input {
            flex: 1; min-width: 100px; padding: 8px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 0.9rem;
        }
        
        button {
            padding: 10px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; border: none; border-radius: 6px; cursor: pointer;
            font-weight: 600; margin: 5px 5px 5px 0; box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
            transition: all 0.2s; font-size: 0.9rem;
        }
        button:hover { transform: translateY(-2px); }
        #add-building { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); width: 100%; margin-bottom: 15px; }
        #process-data { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); width: 100%; margin-bottom: 5px; }
        #check-signal-btn { background: #607d8b; width: 100%; border: 2px solid transparent; }
        #check-signal-btn.active { background: #ff5722; animation: pulse 1.5s infinite; border-color: #ffccbc; }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 87, 34, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 87, 34, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 87, 34, 0); }
        }

        #results { margin-top: 20px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; }
        #results ul { list-style: none; padding: 0; margin: 0; }
        #results li {
            background: white; border: 1px solid #dee2e6; padding: 8px; margin-bottom: 5px;
            border-radius: 4px; font-family: monospace; font-size: 0.85rem;
        }

        .legend-box {
            margin-top: 0; padding: 10px; background: #fff3cd; 
            border: 1px solid #ffeeba; border-radius: 6px; font-size: 0.8rem; margin-bottom: 15px;
        }
        .dot { height: 8px; width: 8px; border-radius: 50%; display: inline-block; margin-right: 5px; }

        /* Popup */
        .signal-popup { text-align: center; min-width: 140px; }
        .signal-bars { font-size: 1.1rem; letter-spacing: 1px; margin: 3px 0; }
        .signal-label { font-size: 0.75rem; color: #666; font-weight: bold; }

        /* Responsive */
        @media (min-width: 768px) {
            #container { 
                flex-direction: row; 
                overflow: hidden; 
            }
            #controls { 
                width: 320px; 
                min-width: 300px; max-width: 350px; 
                border-right: 1px solid #dee2e6; 
                height: 100%; 
                flex-shrink: 0;
            }
            #map { 
                height: 100%; 
                width: auto;
                flex-grow: 1;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-logo-wrapper">
            <img src="https://img2.pic.in.th/pic/LOGO-HONGSON-METAVERSE-MODEL-2.png" alt="Logo ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤" class="header-logo">
        </div>
        <div class="header-content">
            <h1 class="header-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏à‡∏∏‡∏î‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì Wi-Fi (Voronoi)</h1>
            <p class="header-subtitle">‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡πÉ‡∏ô‡∏û‡∏£‡∏∞‡∏≠‡∏∏‡∏õ‡∏ñ‡∏±‡∏°‡∏†‡πå‡∏Ø</p>
        </div>
    </header>

    <div id="container">
        <div id="controls">
            <div style="background: #e3f2fd; padding: 12px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #90caf9;">
                <h3 style="margin: 0 0 8px 0; color: #1565c0; font-size: 1rem;">‚ÑπÔ∏è ‡∏£‡∏±‡∏®‡∏°‡∏µ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì (Aura)</h3>
                <div class="legend-box" style="margin-bottom:0; background: transparent; border:none; padding:0;">
                    <div><span class="dot" style="background: #4CAF50;"></span><strong>5GHz (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß):</strong> ~30m (‡πÅ‡∏£‡∏á/‡∏™‡∏±‡πâ‡∏ô)</div>
                    <div style="margin-top:3px;"><span class="dot" style="background: #FFC107;"></span><strong>2.4GHz (‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á):</strong> ~70m (‡πÑ‡∏Å‡∏•)</div>
                </div>
            </div>
            
            <h2>üìç ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h2>
            
            <div style="margin-bottom: 12px; display: flex; align-items: center; justify-content: space-between;">
                <label style="font-weight: 600; font-size: 0.9rem;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô WiFi:</label>
                <input type="number" id="wifi-count" min="1" value="1" style="padding: 6px; border-radius: 4px; border: 1px solid #ccc; width: 60px; text-align: center;">
            </div>
            
            <div id="building-inputs">
                <div class="building-input">
                    <label>‡∏ï‡∏∂‡∏Å 1:</label>
                    <input type="text" class="lat" value="19.312851">
                    <input type="text" class="lng" value="97.965734">
                </div>
                <div class="building-input">
                    <label>‡∏ï‡∏∂‡∏Å 2:</label>
                    <input type="text" class="lat" value="19.312559">
                    <input type="text" class="lng" value="97.965932">
                </div>
                <div class="building-input">
                    <label>‡∏ï‡∏∂‡∏Å 3:</label>
                    <input type="text" class="lat" value="19.312264">
                    <input type="text" class="lng" value="97.965610">
                </div>
            </div>
            
            <button id="add-building">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</button>
            <hr style="margin: 10px 0; border: 0; border-top: 1px solid #eee;">
            
            <button id="process-data">üöÄ 1. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Aura</button>
            <button id="check-signal-btn">üì∂ 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì</button>

            <div id="results">
                <h3 style="margin:0 0 10px 0; font-size:0.95rem;">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏û‡∏¥‡∏Å‡∏±‡∏î (Lat, Lng)</h3>
                <ul id="vertex-list"><li>- ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• -</li></ul>
            </div>
        </div>

        <div id="map"></div>
    </div>
    
    <footer>
        Copyright ¬© 2025 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ô‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡πÉ‡∏ô‡∏û‡∏£‡∏∞‡∏≠‡∏∏‡∏õ‡∏ñ‡∏±‡∏°‡∏†‡πå‡∏Ø
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- Map Setup ---
            const satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles &copy; Esri', maxZoom: 19
            });
            const osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap', maxZoom: 22
            });

            const map = L.map('map', {
                layers: [satelliteLayer],
                maxZoom: 18,
                zoomControl: false
            }).setView([19.312851, 97.965734], 18);
            
            L.control.zoom({ position: 'topright' }).addTo(map);
            L.control.layers({ "‡∏î‡∏≤‡∏ß‡πÄ‡∏ó‡∏µ‡∏¢‡∏°": satelliteLayer, "‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏ô‡∏ô": osmLayer }, null, { position: 'bottomright' }).addTo(map);
            
            let markerLayer = L.layerGroup().addTo(map);
            let checkSignalMode = false;
            let currentWifiPoints = [];

            // --- Helper Functions ---
            function calculateVoronoiVertices(points, k, maxIterations = 50) {
                if (points.length === 0 || k <= 0) return [];
                if (k >= points.length) return points.map(p => ({ lat: p.lat, lng: p.lng }));
                let vertices = [];
                for(let i=0; i<k; i++) vertices.push(points[Math.floor(Math.random()*points.length)]);
                for(let iter=0; iter<maxIterations; iter++) {
                    const cells = Array(k).fill().map(() => []);
                    points.forEach(p => {
                        let minDist = Infinity, idx = 0;
                        vertices.forEach((v, i) => {
                            const d = Math.pow(p.lat - v.lat, 2) + Math.pow(p.lng - v.lng, 2);
                            if(d < minDist) { minDist = d; idx = i; }
                        });
                        cells[idx].push(p);
                    });
                    const newVertices = vertices.map((v, i) => {
                        if(cells[i].length === 0) return v;
                        return {
                            lat: cells[i].reduce((s, p) => s + p.lat, 0) / cells[i].length,
                            lng: cells[i].reduce((s, p) => s + p.lng, 0) / cells[i].length
                        };
                    });
                    if(JSON.stringify(vertices) === JSON.stringify(newVertices)) break;
                    vertices = newVertices;
                }
                return vertices;
            }

            function getDistanceFromLatLonInM(lat1, lon1, lat2, lon2) {
                var R = 6371; var dLat = deg2rad(lat2-lat1); var dLon = deg2rad(lon2-lon1); 
                var a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon/2) * Math.sin(dLon/2); 
                var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
                return R * c * 1000;
            }
            function deg2rad(deg) { return deg * (Math.PI/180) }

            function getSignalBars(dist, type) {
                let bars = 0; let color = '#F44336';
                if (type === '5G') {
                    if (dist <= 10) { bars = 4; color = '#4CAF50'; }
                    else if (dist <= 20) { bars = 3; color = '#8BC34A'; }
                    else if (dist <= 30) { bars = 2; color = '#FFC107'; }
                    else if (dist <= 35) { bars = 1; color = '#FF9800'; }
                } else {
                    if (dist <= 20) { bars = 4; color = '#4CAF50'; }
                    else if (dist <= 45) { bars = 3; color = '#8BC34A'; }
                    else if (dist <= 70) { bars = 2; color = '#FFC107'; }
                    else if (dist <= 85) { bars = 1; color = '#FF9800'; }
                }
                let barHtml = '';
                for(let i=0; i<4; i++) barHtml += `<span style="display:inline-block; width:6px; height:12px; background:${i < bars ? color : '#ddd'}; margin-right:2px; border-radius:2px;"></span>`;
                return { html: barHtml, bars: bars, color: color };
            }

            // --- Events ---
            const checkBtn = document.getElementById('check-signal-btn');
            checkBtn.addEventListener('click', () => {
                checkSignalMode = !checkSignalMode;
                const mapContainer = document.getElementById('map');
                if(checkSignalMode) {
                    checkBtn.innerHTML = 'üõë ‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
                    checkBtn.classList.add('active');
                    mapContainer.classList.add('crosshair-cursor');
                    map.dragging.enable();
                } else {
                    checkBtn.innerHTML = 'üì∂ 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì';
                    checkBtn.classList.remove('active');
                    mapContainer.classList.remove('crosshair-cursor');
                }
            });

            map.on('click', (e) => {
                if(!checkSignalMode) return;
                if(currentWifiPoints.length === 0) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡πà‡∏≠‡∏ô');
                const clickLat = e.latlng.lat; const clickLng = e.latlng.lng;
                let minDist = Infinity;
                currentWifiPoints.forEach(p => {
                    const d = getDistanceFromLatLonInM(clickLat, clickLng, p.lat, p.lng);
                    if(d < minDist) minDist = d;
                });
                const sig5 = getSignalBars(minDist, '5G');
                const sig24 = getSignalBars(minDist, '2.4G');
                const popupContent = `
                    <div class="signal-popup">
                        <h4 style="margin:0 0 5px 0; border-bottom:1px solid #eee; padding-bottom:5px; font-size:0.9rem;">üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì</h4>
                        <div style="font-size:0.85rem; margin-bottom:8px;">‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á: <b>${minDist.toFixed(1)} m</b></div>
                        <div style="background:#f5f5f5; padding:4px; border-radius:4px; margin-bottom:4px;">
                            <div class="signal-label">5GHz</div>
                            <div class="signal-bars">${sig5.html}</div>
                        </div>
                        <div style="background:#f5f5f5; padding:4px; border-radius:4px;">
                            <div class="signal-label">2.4GHz</div>
                            <div class="signal-bars">${sig24.html}</div>
                        </div>
                    </div>`;
                L.popup().setLatLng(e.latlng).setContent(popupContent).openOn(map);
            });

            document.getElementById('process-data').addEventListener('click', () => {
                checkSignalMode = false;
                checkBtn.classList.remove('active');
                checkBtn.innerHTML = 'üì∂ 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì';
                document.getElementById('map').classList.remove('crosshair-cursor');
                
                markerLayer.clearLayers();
                const list = document.getElementById('vertex-list');
                list.innerHTML = '';
                currentWifiPoints = [];

                const buildings = [];
                document.querySelectorAll('.building-input').forEach((div, i) => {
                    const lat = parseFloat(div.querySelector('.lat').value);
                    const lng = parseFloat(div.querySelector('.lng').value);
                    if(!isNaN(lat) && !isNaN(lng)) {
                        buildings.push({ lat, lng });
                        L.marker([lat, lng]).addTo(markerLayer).bindPopup(`<b>‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ ${i+1}</b>`);
                    }
                });

                if(buildings.length === 0) return alert("‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
                const wifiCount = parseInt(document.getElementById('wifi-count').value) || 1;
                
                if(wifiCount === 1) {
                    const latAvg = buildings.reduce((s, b) => s + b.lat, 0) / buildings.length;
                    const lngAvg = buildings.reduce((s, b) => s + b.lng, 0) / buildings.length;
                    currentWifiPoints = [{ lat: latAvg, lng: lngAvg }];
                } else {
                    currentWifiPoints = calculateVoronoiVertices(buildings, wifiCount);
                }

                currentWifiPoints.forEach((p, i) => {
                    const latLng = [p.lat, p.lng];
                    L.circle(latLng, { color: '#FFC107', fillColor: '#FFC107', fillOpacity: 0.15, radius: 70, weight: 1, dashArray: '5, 5' }).addTo(markerLayer);
                    L.circle(latLng, { color: '#4CAF50', fillColor: '#4CAF50', fillOpacity: 0.3, radius: 30, weight: 1 }).addTo(markerLayer);
                    L.circleMarker(latLng, { radius: 5, color: 'white', weight: 2, fillColor: '#f03', fillOpacity: 1 }).addTo(markerLayer);
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà ${i+1}:</strong> ${p.lat.toFixed(5)}, ${p.lng.toFixed(5)}`;
                    list.appendChild(li);
                });

                const bounds = L.latLngBounds([ ...buildings.map(b => [b.lat, b.lng]), ...currentWifiPoints.map(p => [p.lat, p.lng]) ]);
                map.fitBounds(bounds.pad(0.2));
            });

            document.getElementById('add-building').addEventListener('click', () => {
                const div = document.createElement('div');
                div.className = 'building-input';
                div.innerHTML = `<label>‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£:</label><input type="text" class="lat" placeholder="Lat"><input type="text" class="lng" placeholder="Lng">`;
                document.getElementById('building-inputs').appendChild(div);
            });

            setTimeout(() => document.getElementById('process-data').click(), 800);
        });
    </script>
</body>
</html>
